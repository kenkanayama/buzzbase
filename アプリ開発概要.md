# アプリ開発指示書：バズベース（BuzzBase）実装パッケージ

## 1. プロジェクト概要

インフルエンサー向け「再生数補償型サンプリング」支援Webアプリ。
インフルエンサーが商品投稿URLを登録し、7日後の再生数を自動取得・可視化する。

* **アプリ名:** バズベース（BuzzBase）
* **ターゲット:** インフルエンサー（スマホ利用メイン）
* **デザイン:** スマホファースト・レスポンシブ

## 2. 技術スタック・インフラ構成

* **Frontend:** React (Vite), Tailwind CSS
* **Infrastructure (GCP):**
* **Compute:** Cloud Run (Docker管理)
* **DB:** Cloud Firestore
* **Auth:** Firebase Authentication
* **CI/CD:** GitHub + Cloud Build (Mainブランチマージで自動デプロイ)
* **IaC:** Terraform
* **Batch:** Cloud Scheduler + Cloud Functions (JavaScript / Node.js 20)


* **External:**
* **Email:** Resend (メールリンク認証用)
* **API:** Instagram API (New Pro API), TikTok API



## 3. 開発環境・CI/CD要件

* **Docker:** ローカル開発環境をDocker化すること（`Dockerfile`, `docker-compose.yml`）。
* **GitHub:** GitHubリポジトリの `main` ブランチへのプッシュをトリガーに Cloud Build を実行。
* **Build Pipeline:** Dockerイメージのビルド → Artifact Registryへ保存 → Cloud Runへデプロイ。

## 4. 機能詳細

### A. 認証フロー（Resend + Firebase）

1. **Googleログイン** または **メールアドレス登録**。
2. メール登録の場合：メアド入力 → Resend経由で登録URL送付 → パスワード設定（8-20文字、英数字必須） → ダッシュボードへ。

### B. ダッシュボード

* **ユーザー情報:** 名前（表示）、編集ボタン（名前・住所・電話・振込先）。
* **SNS連携表示:** Instagram/TikTokのアカウント名とステータス（「連携済み」or「要再連携」）。

### C. 商品POST管理

* **URL登録:** SNS選択、商品名（自由入力）、投稿URLを入力。
* **履歴表示:** 登録済み投稿のリスト表示。7日経過後に自動取得された再生数を表示。

### D. 数値取得バッチ（GCP）

* Cloud Schedulerにより毎日 **23:00 JST** に実行。
* 投稿日（JST基準）から **7日目** に該当する投稿を対象に、Instagram APIからインサイトデータを取得。
* 取得データ（リーチ、保存数、再生数、いいね数、コメント数など）を Firestore の `prPosts` コレクションに書き込む。
* 処理フロー: Cloud Scheduler → Pub/Sub → Cloud Functions（再帰的に1件ずつ処理）

## 5. 推奨開発ステップ（AIへの指示順序）

生成AIに対し、以下の順番でコード生成を依頼してください。

1. **【Infrastructure】** TerraformによるGCP基盤（Artifact Registry, Cloud Run, Firestore, Service Account）の定義。
2. **【Dev Environment】** Dockerfile および docker-compose.yml の作成、Vite + Reactの初期構築。
3. **【CI/CD】** `cloudbuild.yaml` の作成とGitHub連携設定のガイド。
4. **【Authentication】** Firebase Auth と Resend を使ったログイン・サインアップフローの実装。
5. **【Frontend & DB】** ダッシュボード UI と Firestore CRUD処理（ユーザー情報・投稿登録）の実装。
6. **【Backend Logic】** Cloud Functions による7日後再生数取得ロジックの雛形作成。
7. **【SNS API】** Instagram/TikTok API 連携の実装（審査通過後の最終工程）。