# =============================================================================
# BuzzBase - Development Dockerfile
# =============================================================================

FROM node:20-alpine

WORKDIR /app

# npmのキャッシュディレクトリを設定
ENV NPM_CONFIG_CACHE=/app/.npm-cache

# 開発時に必要なツールをインストール
RUN apk add --no-cache git su-exec

# entrypointスクリプトをコピー
COPY frontend/docker-entrypoint.sh /usr/local/bin/docker-entrypoint.sh
RUN chmod +x /usr/local/bin/docker-entrypoint.sh

# ユーザー権限の設定（node_modulesの権限問題を回避）
RUN chown -R node:node /app

# Vite開発サーバーのポート
EXPOSE 5173

# entrypointを設定
ENTRYPOINT ["/usr/local/bin/docker-entrypoint.sh"]

